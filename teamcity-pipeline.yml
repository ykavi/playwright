version: 2022.04

# Proje tanımı
projects:
  - name: Playwright TeamCity Example
    id: Playwright_TeamCity_Example
    description: Playwright testlerini TeamCity'de çalıştırma
    buildTypes:
      - name: Run Playwright Tests
        id: PlaywrightTests
        steps:
          # Adım 1: Node.js bağımlılıklarını yükle
          - script:
              name: Install Dependencies
              scriptContent: |
                npm ci

          # Adım 2: Playwright testlerini çalıştır
          - script:
              name: Run Playwright Tests
              scriptContent: |
                TEST_URL=%test.url% npm run test

        features:
          # JUnit XML raporlarını işle
          - type: xml-report-plugin
            param:
              xmlReportParsing.reportType: junit
              xmlReportParsing.reportDirs: test-results/results.xml

        params:
          # Dinamik URL parametresi
          - name: test.url
            value: http://example.com

        triggers:
          # Örnek tetikleyici: Git'te her push olduğunda testleri çalıştır
          - vcsTrigger:
              name: Trigger on Git Push
              perCheckinTriggering: true
              groupCheckinsByCommitter: true

